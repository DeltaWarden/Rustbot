# RustBot YOLO Pipeline

Этот проект предназначен для автоматизации сбора данных, разметки, обучения и тестирования нейросетей для детекции объектов (например, игроков) на скриншотах из игр. Всё управление происходит через удобное меню в терминале.

## Быстрый старт

1. Установите зависимости:
   
   ```bash
   pip install torch torchvision pillow mss opencv-python flask
   ```
   (и другие, если потребуется)

2. Запустите основной скрипт:
   
   ```bash
   python yolo_pipeline.py
   ```

## Как пользоваться меню?

После запуска `yolo_pipeline.py` вы увидите меню:

```
--- YOLOv5 Pipeline ---
1. Собирать скриншоты
2. Размечать скриншоты
3. Обучить модель
4. Запустить "зрение" нейронки
5. Выйти
```

### 1. Собирать скриншоты
- Скрипт автоматически делает скриншоты экрана (по умолчанию 250 штук, 1 раз в секунду).
- Перед стартом есть задержка 5 секунд, чтобы вы успели открыть игру или нужное окно.
- Скриншоты сохраняются в папку `raw_screens`.

### 2. Размечать скриншоты
- Откроется графический интерфейс для разметки.
- Сначала введите название класса (например, "player").
- Для каждого скрина выделяйте объекты прямоугольником (bbox) мышкой.
- После разметки каждого скрина нажимайте "Дальше".
- Разметка сохраняется в папку `labels`.

### 3. Обучить модель
- Скрипт автоматически подготовит датасет, разобьёт его на train/val, сгенерирует все нужные файлы и запустит обучение YOLOv5.
- После обучения веса сохраняются в папку `runs/train/auto_yolo_train/weights`.

### 4. Запустить "зрение" нейронки
- Откроется окно, в котором нейросеть будет в реальном времени анализировать ваш экран.
- Если найдёт объект — обведёт его зелёным прямоугольником и подпишет класс.
- Скриншоты с обнаружениями сохраняются в папку `detected_screens`.

### 5. Выйти
- Завершает работу программы.


## Проверка разметки

Для быстрой проверки качества разметки используйте скрипт `check_bboxes.py`:

```bash
python check_bboxes.py
```

- Скрипт нарисует все bbox из разметки на соответствующих скринах и сохранит результат в папку `check_bboxes_vis`.
- Откройте картинки из этой папки и убедитесь, что bbox совпадают с объектами.

## Тест

- В папке runs/train/auto_yolo_train есть готовая модель которую можно протестировать!
- Для теста своей модели соберите датасет (Собрать скриншоты), создайте разметку (Размечать скриншоты) и обучите модель (Обучить модель)! После в файле yolo_pipeline.py нужно поменять путь к своей модели(Например: runs/train/auto_yolo_train1/weights/best.pt):

```bash
RAW_DIR = 'raw_screens'
LABELS_DIR = 'labels'
DATASET_DIR = 'dataset'
IMAGES_DIR = os.path.join(DATASET_DIR, 'images')
LABELS_YOLO_DIR = os.path.join(DATASET_DIR, 'labels')
CLASSES_TXT = os.path.join(DATASET_DIR, 'classes.txt')
DATASET_YAML = os.path.join(DATASET_DIR, 'dataset.yaml')
YOLOV5_CFG = 'yolov5s.yaml'
MODEL_PATH = 'runs/train/auto_yolo_train/weights/best.pt' # Поменять путь к своей модели
IMG_SIZE = 640
TRAIN_RATIO = 0.8
REFRESH_MS = 1
```

## Структура проекта

- `yolo_pipeline.py` — основной скрипт-менеджер (меню, сбор, разметка, обучение, инференс)
- `check_bboxes.py` — визуализация разметки
- `raw_screens/` — папка для скриншотов
- `labels/` — папка для разметки
- `dataset/` — подготовленные данные для обучения
- `detected_screens/` — скриншоты с обнаружениями
- `check_bboxes_vis/` — визуализация bbox


## Советы
- Для корректной работы желательно запускать скрипты с правами администратора.
- Для обучения требуется установленный PyTorch и YOLOv5 (или доступ через torch.hub).
- Если что-то не работает — проверьте структуру папок и наличие всех зависимостей.


## License

The project uses the MIT license

## tg: @deltasquare

